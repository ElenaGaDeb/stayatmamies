<div class="main-container">
  <div class="container">
    <div class="row">
     <% if policy(@profile).edit? %>

        <!-- <div class="block clearfix"> -->

<div class="main col-12">
<h1 class="page-title"><%= @profile.first_name.capitalize %>'s Profile</h1>
                  <span>
                  <i class="fa fa-star text-default"></i>
                  <i class="fa fa-star text-default"></i>
                  <i class="fa fa-star text-default"></i>
                  <i class="fa fa-star text-default"></i>
                  <i class="fa fa-star"></i>
                  </span>
<div class="separator-2"></div>


        <div class="container">
          <div class="row">

              <div class="col-lg-4">
                <% if  @profile.photo? %>
                <%= cl_image_tag @profile.photo.path, width: 400, height: 400, crop: :fill %>
                <% else %>
                <%= image_tag "no-photo.png", width: 400, height: 400, crop: :fill %>
                <% end %>
              </div>
              <div class="col-lg-4">

                <h4>About Me</h4>
                my username: @<%= @profile.username %>
                <h5><%= @profile.first_name.capitalize %> - <%= @profile.age%> years old - Originally from <%= @profile.city_from%> </h5>
                <h3><%= @profile.short_description %></h3>

                <p><%= @profile.detailed_description %></p>
              </div>

            <div class="col-lg-4">
            <div class="pv-30 ph-20 white-bg feature-box bordered text-center">
            <h3 class="title">My tools</h3>
        <div class="separator-2"></div>
        <%= link_to "Update my profile's info", edit_profile_path(@profile) %>
        <br>
        <br>
        <h4>Your Booking Requests</h4>
        <% if @profile.user.apartment == nil && @profile.profile_type == "host" %>
        <%= link_to "Add your apartment", new_apartment_path %>
        <% end %>

        <% if @profile.profile_type == "host" && @profile.user.apartment %>

          <% @profile.user.apartment.bookings.each do |booking| %>
          <div class="separator-2 mt-20 clearfix"></div>
                <ul class="list-unstyled small list-icons text-left">
                  <li><strong class="text-default"> Requested by </strong> <span class="pull-right"> <%= booking.user.profile.first_name %> </span></li>
                  <li><strong class="text-default">From:</strong> <span class="pull-right"> <%= booking.start_date %> </span></li>
                  <li><strong class="text-default">To:</strong> <span class="pull-right"><%= booking.end_date %> </span></li>
                  <li><strong class="text-default">Booking is </strong> <span class="pull-right"><%= booking.status %> </span></li>

                  <% if  booking.status == 'pending' %>
                    <%= simple_form_for([booking.apartment, booking]) do |f| %>
                      <%= f.hidden_field :status, value: 'Accepted' %>
                      <%= f.button :submit, 'Accept', method: :patch %>
                    <% end %>

                    <%= simple_form_for([booking.apartment, booking]) do |f| %>
                      <%= f.hidden_field :status, value: 'Rejected' %>
                      <%= f.button :submit, 'Reject', method: :put %>
                    <% end %>
                  <% end %>

          <% end %>
        <% end %>

                </ul>
            </div>
            </div>
            </div>
            </div>
            </div>
        <!-- bookings -->


        <% if @profile.profile_type == "student" && @profile.user.bookings %>
          <% @profile.user.bookings.each do |booking| %>
            <%= booking.apartment.name %>
            <%= booking.apartment.user.profile.first_name %>
            <%= booking.start_date %>
            <%= booking.end_date %>
            <%= booking.status %>
          <% end %>
        <% end %>

      </div>


    </div>
    </div>
    <% end %>




            </div>
          </div>
        </div>


       <!-- reviews start -->
        <div class="pv-30 light-gray-bg">
        <div class="container">
          <div class="row">
            <div class="col-lg-8">
              <h2 class="title"><%= @reviews_for.count %> reviews</h2>
              <div class="separator-2"></div>
              <!-- comments start -->
              <div class="comments margin-clear space-top">
                <% if @reviews_for.blank? %>
                  Be the first to leave a review on <%= @profile.first_name %>'s profile :)
                <% else %>
                  <% @reviews_for.reverse.each do |review| %>
                  <!-- comment start -->
                  <%= render 'reviews/show', review: review %>
                  <!-- comment end -->
                  <% end %>
                <% end %>
              </div>
              <!-- comments end -->

              <!-- comments form start -->
              <%= render 'reviews/form', profile: @profile, review: @review %>
              <!-- comments form end -->
            </div>

          <!-- sidebar start -->
          <!-- ================ -->
        </div>
      </div>
    </div>
     <!-- reviews end -->




